#!/bin/bash

set -exuo pipefail

if command -v zsh >/dev/null; then
  sudo chsh -s $(command -v zsh) $USER
fi

CHEZMOI_PATH="$(command -v chezmoi)"
MISE_PATH="$(command -v mise)"

if [ -n "$CHEZMOI_PATH" ]; then
  $CHEZMOI_PATH -- chezmoi init --apply --source $PWD
  exit
fi

if [ -n "$MISE_PATH" ]; then
  $MISE_PATH exec chezmoi -- chezmoi init --apply --source $PWD
  exit
fi

sh -c "$(curl -fsLS get.chezmoi.io)" -- init --apply --source $PWD
exit

exit 1
