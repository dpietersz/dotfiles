#!/bin/bash
# faker installation hash: {{ include "dot_config/mise/config.toml" | sha256sum }}

set -euo pipefail

# Check if faker is already installed
if npm list -g faker >/dev/null 2>&1; then
  echo "faker is already installed"
  exit 0
fi

# Install faker via npm (managed by mise on all platforms)
# Reference: https://github.com/faker-js/faker
MISE_BIN_PATH="{{ if $m := lookPath "mise" }}{{ $m }}{{ else if $l := lookPath (joinPath .chezmoi.homeDir ".local/bin/mise") }}{{ $l }}{{ else }}mise{{ end }}"

if [ -x "$MISE_BIN_PATH" ]; then
  echo "Installing faker via npm..."
  $MISE_BIN_PATH exec -- npm install -g @faker-js/faker
  echo "faker installed successfully"
else
  echo "Error: mise not found. Cannot install faker."
  exit 1
fi

