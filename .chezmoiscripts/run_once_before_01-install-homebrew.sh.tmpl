#!/bin/bash
set -euo pipefail
{{- if not .remote }}

# Check if Homebrew is already installed
if command -v brew >/dev/null; then
  echo "Homebrew already installed"
  exit 0
fi

{{- if eq .chezmoi.os "darwin" }}
# macOS - Install Homebrew
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

{{- else if or (eq (get .chezmoi.osRelease "id" "") "bazzite") (eq (get .chezmoi.osRelease "id" "") "bluefin") }}
# Fedora Atomic (Bluefin/Bazzite) - Usually pre-installed
echo "Homebrew should be pre-installed on Bluefin/Bazzite"
echo "If missing, manually install from: https://brew.sh"

{{- else if or (or (eq (get .chezmoi.osRelease "id" "") "fedora") (eq (get .chezmoi.osRelease "id" "") "centos")) (or (eq (get .chezmoi.osRelease "idLike" "") "fedora") (or (eq (get .chezmoi.osRelease "id" "") "arch") (or (eq (get .chezmoi.osRelease "id" "") "manjaro") (or (eq (get .chezmoi.osRelease "id" "") "void") (or (eq (get .chezmoi.osRelease "id" "") "ubuntu") (eq (get .chezmoi.osRelease "id" "") "debian")))))) }}
# Linux - Install Homebrew
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

{{- else }}
echo "Homebrew installation not configured for this distribution"
echo "Visit: https://brew.sh"

{{- end }}
{{- end }}
