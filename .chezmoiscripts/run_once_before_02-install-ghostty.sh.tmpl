#!/bin/bash
{{- if not .remote }}

{{- if eq .chezmoi.os "darwin" }}
if command -v brew >/dev/null; then
  brew install --cask ghostty
else
  echo "Homebrew not installed. Download from: https://ghostty.org/download"
fi

{{- else if eq .chezmoi.osRelease.id "bluefin" }}
. /etc/os-release
curl -fsSL "https://copr.fedorainfracloud.org/coprs/scottames/ghostty/repo/fedora-${VERSION_ID}/scottames-ghostty-fedora-${VERSION_ID}.repo" | sudo tee /etc/yum.repos.d/_copr:copr.fedorainfracloud.org:scottames:ghostty.repo > /dev/null
rpm-ostree refresh-md && rpm-ostree install ghostty
echo "Reboot required to complete Ghostty installation"

{{- else if or (eq .chezmoi.osRelease.id "fedora") (eq .chezmoi.osRelease.idLike "fedora") }}
if command -v dnf >/dev/null; then
  sudo dnf copr enable -y scottames/ghostty
  sudo dnf install -y ghostty
fi

{{- else }}
echo "No installation instructions present for Ghostty in your distribution."
echo "Update the template using source: https://ghostty.org/docs/install/build"

{{- end }}
{{- end }}
